<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fibonacci Betting Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }

        .header h1 {
            font-size: 1.8rem;
            margin-bottom: 8px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .main-content {
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .card h2 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.3rem;
            border-bottom: 2px solid #4facfe;
            padding-bottom: 8px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 6px;
            color: #555;
            font-weight: 500;
            font-size: 0.9rem;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }

        .btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
            width: 100%;
            display: block;
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 10px rgba(79, 172, 254, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #757f9a 0%, #d7dde8 100%);
        }

        .sequence-display {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }

        .sequence-display h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .fib-numbers {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 10px;
        }

        .fib-number {
            background: #4facfe;
            color: white;
            padding: 6px 10px;
            border-radius: 5px;
            font-weight: bold;
            font-size: 0.8rem;
            position: relative;
            min-width: 35px;
            text-align: center;
        }

        .fib-number.current {
            background: #ff416c;
            transform: scale(1.1);
            box-shadow: 0 2px 5px rgba(255, 65, 108, 0.4);
        }

        .fib-index {
            position: absolute;
            top: -6px;
            right: -6px;
            background: #333;
            color: white;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .betting-form {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }

        .bet-calculation {
            background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%);
            padding: 12px;
            border-radius: 10px;
            margin: 15px 0;
            text-align: center;
            font-weight: bold;
            font-size: 1rem;
        }

        .series-container {
            background: white;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            margin-bottom: 15px;
            border-left: 4px solid #4facfe;
        }

        .series-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid #e1e5e9;
        }

        .series-title {
            font-size: 1.1rem;
            font-weight: bold;
            color: #333;
        }

        .series-profit {
            font-size: 1rem;
            font-weight: bold;
            padding: 4px 12px;
            border-radius: 20px;
        }

        .series-profit.positive {
            background: rgba(86, 171, 47, 0.1);
            color: #56ab2f;
        }

        .series-profit.negative {
            background: rgba(255, 65, 108, 0.1);
            color: #ff416c;
        }

        .series-profit.zero {
            background: rgba(117, 127, 154, 0.1);
            color: #757f9a;
        }

        .game-list {
            margin-top: 12px;
        }

        .game-item {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 8px;
            align-items: center;
            font-size: 0.85rem;
        }

        .game-item:last-child {
            background: #e3f2fd;
            border: 2px solid #4facfe;
        }

        .game-number {
            font-weight: bold;
            color: #666;
        }

        .game-match {
            font-weight: 500;
            grid-column: span 2;
        }

        .game-odds {
            text-align: center;
            font-family: monospace;
        }

        .game-bet {
            text-align: center;
            font-weight: bold;
            color: #4facfe;
        }

        .game-result {
            text-align: center;
            font-weight: bold;
            padding: 4px 8px;
            border-radius: 4px;
        }

        .game-result.win {
            background: rgba(86, 171, 47, 0.1);
            color: #56ab2f;
        }

        .game-result.lose {
            background: rgba(255, 65, 108, 0.1);
            color: #ff416c;
        }

        .game-result.pending {
            background: rgba(255, 193, 7, 0.1);
            color: #ffc107;
        }

        .game-result.betting {
            background: rgba(79, 172, 254, 0.1);
            color: #4facfe;
        }

        .series-controls {
            margin-top: 12px;
            display: flex;
            gap: 10px;
        }

        .series-controls .btn {
            margin: 0;
            flex: 1;
            padding: 10px;
            font-size: 0.9rem;
        }

        .game-profit {
            text-align: center;
            font-weight: bold;
            font-family: monospace;
            grid-column: span 2;
        }

        .total-stats {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            margin-bottom: 15px;
        }

        .total-stats h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .total-profit {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .total-profit.positive { color: #56ab2f; }
        .total-profit.negative { color: #ff416c; }
        .total-profit.zero { color: #757f9a; }

        .controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 15px 0;
        }

        .right-panel {
            max-height: none;
            overflow-y: visible;
        }

        /* Desktop styles */
        @media (min-width: 768px) {
            body {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2.5rem;
            }
            
            .header p {
                font-size: 1.1rem;
            }
            
            .main-content {
                padding: 30px;
                flex-direction: row;
            }
            
            .left-panel {
                width: 400px;
            }
            
            .right-panel {
                flex: 1;
            }
            
            .game-item {
                grid-template-columns: auto 1fr auto auto auto auto;
            }
            
            .game-match {
                grid-column: auto;
            }
            
            .game-profit {
                grid-column: auto;
            }
            
            .controls {
                flex-direction: row;
            }
            
            .series-controls {
                justify-content: center;
            }
        }

        @media (max-width: 767px) {
            .fib-number {
                font-size: 0.7rem;
                padding: 5px 8px;
                min-width: 30px;
            }
            
            .fib-index {
                width: 14px;
                height: 14px;
                font-size: 8px;
                top: -5px;
                right: -5px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎯 Fibonacci Betting Calculator</h1>
            <p>Betting system: Lose - move forward, Win - move back 2 positions</p>
        </div>

        <div class="main-content">
            <!-- Left Panel - Controls -->
            <div class="left-panel">
                <div class="card">
                    <h2>📊 Series Settings</h2>
                    
                    <div class="form-group">
                        <label>Minimum Bet (THB)</label>
                        <input type="number" id="minBet" value="10" min="1">
                    </div>

                    <div class="sequence-display">
                        <h3>🔢 Fibonacci Sequence</h3>
                        <div class="fib-numbers" id="fibSequence"></div>
                    </div>

                    <div class="controls">
                        <button class="btn" onclick="createNewSeries()">📝 Create New Series</button>
                        <button class="btn btn-secondary" onclick="resetAll()">🗑️ Reset All</button>
                    </div>

                    <!-- Current Betting Form -->
                    <div class="betting-form">
                        <h3>🎮 Next Bet</h3>
                        
                        <div class="form-group">
                            <label>Select Series</label>
                            <select id="selectedSeries">
                                <option value="">-- Select Series --</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Match Name (e.g. Team A vs Team B)</label>
                            <input type="text" id="matchName" placeholder="Enter match name">
                        </div>

                        <div class="form-group">
                            <label>Odds</label>
                            <input type="number" id="odds" value="0.95" step="0.01" min="0.01" max="10">
                        </div>

                        <div class="bet-calculation" id="betCalculation">
                            Bet Amount: <span id="calculatedBet">0</span> THB
                        </div>

                        <div class="controls">
                            <button class="btn" id="bettingBtn" onclick="startBetting()">🎯 Place Bet</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Panel - Series List -->
            <div class="right-panel">
                <div class="total-stats">
                    <h3>📈 Total Summary</h3>
                    <div class="total-profit" id="totalProfit">0</div>
                    <div>THB</div>
                </div>

                <div id="seriesList">
                    <!-- Series will be dynamically added here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        let gameData = {
            minBet: 10,
            fibSequence: [1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144],
            series: [],
            currentSeriesId: null
        };

        // Load data from browser
        function loadData() {
            const savedData = JSON.parse(localStorage.getItem('fibonacciBettingNew') || '{}');
            gameData = { ...gameData, ...savedData };
            updateDisplay();
        }

        // Save data
        function saveData() {
            localStorage.setItem('fibonacciBettingNew', JSON.stringify(gameData));
        }

        // Create new series
        function createNewSeries() {
            const minBet = parseInt(document.getElementById('minBet').value);
            gameData.minBet = minBet;

            const newSeries = {
                id: Date.now(),
                name: `Series ${gameData.series.length + 1}`,
                minBet: minBet, // Store minBet for this series
                currentFibIndex: 0,
                games: [],
                totalProfit: 0,
                isCompleted: false,
                currentBetting: null
            };

            gameData.series.unshift(newSeries);
            
            updateDisplay();
            saveData();
        }

        // Calculate bet amount
        function calculateBetAmount(series, fibIndex, odds) {
            if (fibIndex >= gameData.fibSequence.length) {
                fibIndex = gameData.fibSequence.length - 1;
            }
            const baseAmount = series.minBet * gameData.fibSequence[fibIndex];
            return Math.ceil(baseAmount / odds);
        }

        // Start betting
        function startBetting() {
            const selectedSeriesId = parseInt(document.getElementById('selectedSeries').value);
            const matchName = document.getElementById('matchName').value.trim();
            const odds = parseFloat(document.getElementById('odds').value);

            if (!selectedSeriesId) {
                alert('Please select a series');
                return;
            }

            if (!matchName) {
                alert('Please enter match name');
                return;
            }

            const series = gameData.series.find(s => s.id === selectedSeriesId);
            if (!series) return;

            const betAmount = calculateBetAmount(series, series.currentFibIndex, odds);

            // Save current betting info
            series.currentBetting = {
                matchName: matchName,
                odds: odds,
                betAmount: betAmount,
                fibIndex: series.currentFibIndex
            };

            // Clear form
            document.getElementById('selectedSeries').value = '';
            document.getElementById('matchName').value = '';
            document.getElementById('odds').value = '0.95';

            updateDisplay();
            saveData();
        }

        // Record result
        function recordResult(seriesId, isWin) {
            const series = gameData.series.find(s => s.id === seriesId);
            if (!series || !series.currentBetting) return;

            const betting = series.currentBetting;
            let netProfit;

            if (isWin) {
                netProfit = betting.betAmount * betting.odds - betting.betAmount;
                // Win: move back 2 positions (but not below 0)
                series.currentFibIndex = Math.max(0, series.currentFibIndex - 2);
            } else {
                netProfit = -betting.betAmount;
                // Lose: move to next position
                series.currentFibIndex++;
            }

            // Save game record
            const gameRecord = {
                gameNumber: series.games.length + 1,
                matchName: betting.matchName,
                odds: betting.odds,
                fibIndex: betting.fibIndex,
                betAmount: betting.betAmount,
                result: isWin ? 'Win' : 'Lose',
                netProfit: netProfit
            };

            series.games.push(gameRecord);
            series.totalProfit += netProfit;
            series.currentBetting = null;

            updateDisplay();
            saveData();
        }

        // Update display
        function updateDisplay() {
            // Update Fibonacci sequence
            const fibContainer = document.getElementById('fibSequence');
            fibContainer.innerHTML = '';
            gameData.fibSequence.forEach((num, index) => {
                const span = document.createElement('span');
                span.className = 'fib-number';
                span.innerHTML = `${num}<div class="fib-index">${index}</div>`;
                fibContainer.appendChild(span);
            });

            // Update series selector
            updateSeriesSelector();

            // Update bet calculation
            updateBetCalculation();

            // Update series list
            updateSeriesList();

            // Update total stats
            updateTotalStats();
        }

        // Update series selector
        function updateSeriesSelector() {
            const select = document.getElementById('selectedSeries');
            select.innerHTML = '<option value="">-- Select Series --</option>';
            
            gameData.series
                .filter(s => !s.isCompleted)
                .forEach(series => {
                    const option = document.createElement('option');
                    option.value = series.id;
                    option.textContent = `${series.name} (Position: ${series.currentFibIndex})`;
                    select.appendChild(option);
                });
        }

        // Update bet calculation
        function updateBetCalculation() {
            const seriesSelect = document.getElementById('selectedSeries');
            const oddsInput = document.getElementById('odds');
            const calculatedBetSpan = document.getElementById('calculatedBet');

            function calculate() {
                const selectedSeriesId = parseInt(seriesSelect.value);
                const selectedSeries = gameData.series.find(s => s.id === selectedSeriesId);
                
                if (selectedSeries) {
                    const odds = parseFloat(oddsInput.value) || 0.95;
                    const betAmount = calculateBetAmount(selectedSeries, selectedSeries.currentFibIndex, odds);
                    calculatedBetSpan.textContent = betAmount.toLocaleString();
                } else {
                    calculatedBetSpan.textContent = '0';
                }
            }

            calculate();
            seriesSelect.addEventListener('change', calculate);
            oddsInput.addEventListener('input', calculate);
        }

        // Update series list
        function updateSeriesList() {
            const container = document.getElementById('seriesList');
            container.innerHTML = '';

            gameData.series.forEach(series => {
                const seriesDiv = document.createElement('div');
                seriesDiv.className = 'series-container';
                
                let profitClass = 'zero';
                if (series.totalProfit > 0) profitClass = 'positive';
                else if (series.totalProfit < 0) profitClass = 'negative';

                seriesDiv.innerHTML = `
                    <div class="series-header">
                        <div class="series-title">${series.name}</div>
                        <div class="series-profit ${profitClass}">
                            ${series.totalProfit > 0 ? '+' : ''}${series.totalProfit.toLocaleString()} THB
                        </div>
                    </div>
                    <div class="game-list" id="games-${series.id}"></div>
                `;

                container.appendChild(seriesDiv);

                // Add games to series
                const gamesContainer = document.getElementById(`games-${series.id}`);
                series.games.forEach(game => {
                    const gameDiv = document.createElement('div');
                    gameDiv.className = 'game-item';
                    gameDiv.innerHTML = `
                        <div class="game-number">Bet ${game.gameNumber}</div>
                        <div class="game-match">${game.matchName}</div>
                        <div class="game-odds">${game.odds}</div>
                        <div class="game-bet">${game.betAmount.toLocaleString()}฿</div>
                        <div class="game-result ${game.result === 'Win' ? 'win' : 'lose'}">
                            ${game.result}
                        </div>
                        <div class="game-profit" style="color: ${game.netProfit >= 0 ? '#56ab2f' : '#ff416c'}">
                            ${game.netProfit > 0 ? '+' : ''}${game.netProfit.toLocaleString()}฿
                        </div>
                    `;
                    gamesContainer.appendChild(gameDiv);
                });

                // Show next bet if currently betting
                if (series.currentBetting) {
                    const bettingGameDiv = document.createElement('div');
                    bettingGameDiv.className = 'game-item';
                    bettingGameDiv.innerHTML = `
                        <div class="game-number">Bet ${series.games.length + 1}</div>
                        <div class="game-match">${series.currentBetting.matchName}</div>
                        <div class="game-odds">${series.currentBetting.odds}</div>
                        <div class="game-bet">${series.currentBetting.betAmount.toLocaleString()}฿</div>
                        <div class="game-result betting">Betting</div>
                        <div class="game-profit">Waiting</div>
                    `;
                    gamesContainer.appendChild(bettingGameDiv);
                }

                // Add win/lose buttons if currently betting
                if (series.currentBetting) {
                    seriesDiv.innerHTML += `
                        <div class="series-controls">
                            <button class="btn btn-success" onclick="recordResult(${series.id}, true)">✅ Win</button>
                            <button class="btn btn-danger" onclick="recordResult(${series.id}, false)">❌ Lose</button>
                        </div>
                    `;
                } else {
                    seriesDiv.innerHTML += `
                        <div class="series-controls">
                            <button class="btn btn-secondary" onclick="completeSeries(${series.id})">✅ Complete</button>
                            <button class="btn btn-danger" onclick="deleteSeries(${series.id})">🗑️ Delete</button>
                        </div>
                    `;
                }
            });
        }

        // Update total stats
        function updateTotalStats() {
            const totalProfit = gameData.series.reduce((sum, series) => sum + series.totalProfit, 0);
            const totalProfitElement = document.getElementById('totalProfit');
            
            totalProfitElement.textContent = (totalProfit > 0 ? '+' : '') + totalProfit.toLocaleString();
            
            totalProfitElement.className = 'total-profit ';
            if (totalProfit > 0) totalProfitElement.className += 'positive';
            else if (totalProfit < 0) totalProfitElement.className += 'negative';
            else totalProfitElement.className += 'zero';
        }

        // Complete series
        function completeSeries(seriesId) {
            const series = gameData.series.find(s => s.id === seriesId);
            if (series) {
                series.isCompleted = true;
                series.currentBetting = null;
                updateDisplay();
                saveData();
            }
        }

        // Delete series
        function deleteSeries(seriesId) {
            if (confirm('Are you sure you want to delete this series?')) {
                gameData.series = gameData.series.filter(s => s.id !== seriesId);
                updateDisplay();
                saveData();
            }
        }

        // Reset all
        function resetAll() {
            if (confirm('Are you sure you want to delete all data?')) {
                gameData = {
                    minBet: 10,
                    fibSequence: [1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144],
                    series: []
                };
                updateDisplay();
                saveData();
            }
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            
            // Update min bet
            document.getElementById('minBet').addEventListener('change', function() {
                gameData.minBet = parseInt(this.value);
                updateDisplay();
                saveData();
            });
        });
    </script>
</body>
</html>